#!/usr/bin/env ruby

Dir['zsh/bundle/*'].each do |d|
  Dir.chdir(d) do
    `git pull`
  end
end

# Update theme submodules
puts "Updating Catppuccin themes..."
`git submodule update --remote themes/`

# Rebuild bat cache if themes were updated
if system("git diff --quiet HEAD themes/catppuccin-bat") == false
  puts "Rebuilding bat cache..."
  `bat cache --build 2>/dev/null`
end

`git pull`

def push_to_github()
  `git add zsh/bundle`
  `git commit -m 'ZSH plugin update'`
  `git push`
end

push_to_github unless `git status` =~ /nothing to commit/
