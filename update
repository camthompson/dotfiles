#!/usr/bin/env ruby

# Update all submodules (themes and zsh plugins)
puts "Updating submodules..."
puts "  Updating zsh plugins..."
`git submodule update --remote zsh/bundle/`
puts "  Updating Catppuccin themes..."
`git submodule update --remote themes/`

# Rebuild bat cache if themes were updated
if system("git diff --quiet HEAD themes/catppuccin-bat") == false
  puts "Rebuilding bat cache..."
  `bat cache --build 2>/dev/null`
end

`git pull`

def push_to_github()
  `git add zsh/bundle`
  `git commit -m 'ZSH plugin update'`
  `git push`
end

push_to_github unless `git status` =~ /nothing to commit/
